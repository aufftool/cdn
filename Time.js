

  // ===== code by madhav =====





!function(){const e=36e5,t=[{name:"WorldTimeAPI",url:"https://worldtimeapi.org/api/ip",parser:e=>{const[t]=e.datetime.split("T");return t.split("-").map(Number)}},{name:"TimeAPI",url:"https://timeapi.io/api/Time/current/zone?timeZone=UTC",parser:e=>[e.year,e.month,e.day]},{name:"NTPJS",url:"https://ntpjs-server.vercel.app/api/time",parser:e=>{const t=new Date(e.currentUtcTime);return[t.getUTCFullYear(),t.getUTCMonth()+1,t.getUTCDate()]}}];let n=null,a=!0,o=0,i=Date.now(),r=0;const l=document.createElement("div");function getCurrentDate(){const e=new Date;return[e.getFullYear(),e.getMonth()+1,e.getDate()]}function datesMatch(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]}function formatDate(e){return e?`${e[2]}/${e[1]}/${e[0]}`:"Unknown"}async function fetchDateFromAPI(e){const n=t[e],a=new AbortController,o=setTimeout((()=>a.abort()),3e3);try{Date.now();const e=await fetch(n.url,{cache:"no-store",signal:a.signal,headers:{"Content-Type":"application/json"}});if(!e.ok)throw new Error(`HTTP ${e.status}`);const t=await e.json(),o=n.parser(t);if(!o||3!==o.length)throw new Error("Invalid date format from API");return i=Date.now(),o}catch(r){throw console.warn(`Failed to fetch from ${n.name}:`,r.message),r}finally{clearTimeout(o)}}async function validateDate(){const e=getCurrentDate();try{const{success:i,date:s,error:d}=await async function validateDateWithFallback(){let e;for(let n=0;n<t.length;n++){const a=(r+n)%t.length;try{const e=await fetchDateFromAPI(a);return r=a,{success:!0,date:e}}catch(d){e=d}}return{success:!1,error:e}}();i?(document.getElementById("onlineWarning").style.display="block",document.getElementById("offlineWarning").style.display="none",document.getElementById("clientDateDisplay").textContent=formatDate(e),document.getElementById("serverDateDisplay").textContent=formatDate(s),datesMatch(e,s)?(!function handleDateValid(){if(a)return;a=!0,o=0,l.style.display="none",document.body.style.overflow="",document.querySelectorAll("button, input, a, [onclick]").forEach((e=>{e.style.pointerEvents="",e.style.opacity=""}))}(),n=s):handleDateViolation(e,s)):handleOfflineState(e,d)}catch(i){console.error("Unexpected validation error:",i),handleOfflineState(e,i)}}function handleOfflineState(t,o){const r=Date.now()-i;document.getElementById("onlineWarning").style.display="none",document.getElementById("offlineWarning").style.display="block",document.getElementById("lastValidDateDisplay").textContent=n?formatDate(n):"Never",document.getElementById("offlineDuration").textContent=`${Math.floor(r/6e4)} minutes`,n&&(r>e||!datesMatch(t,n))?handleDateViolation(t,n):(a=!0,l.style.display="none",document.body.style.overflow="")}function handleDateViolation(e,t){o++,a=!1,1===o&&(l.style.display="flex",document.body.style.overflow="hidden",document.querySelectorAll("button, input, a, [onclick]").forEach((e=>{e.style.pointerEvents="none",e.style.opacity="0.5"}))),console.error(`Date violation #${o}:\n      Client: ${formatDate(e)}\n      Server: ${formatDate(t)}`)}l.id="dateValidationOverlay",l.style.cssText="\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    background: rgba(0,0,0,0.96);\n    color: #ff6b6b;\n    display: none;\n    flex-direction: column;\n    justify-content: center;\n    align-items: center;\n    z-index: 9999;\n    font-family: Arial, sans-serif;\n    text-align: center;\n    backdrop-filter: blur(5px);\n  ",l.innerHTML='\n    <div style="max-width: 600px; padding: 20px;">\n      <h2 style="font-size: 1.8em; margin-bottom: 15px;">⚠️ DATE VERIFICATION ISSUE</h2>\n      \n      <div id="onlineWarning" style="background: rgba(255,107,107,0.1); padding: 15px; border-radius: 8px; margin: 15px 0;">\n        <p>Your system date doesn\'t match our servers:</p>\n        <p><strong>Your Date:</strong> <span id="clientDateDisplay"></span></p>\n        <p><strong>Server Date:</strong> <span id="serverDateDisplay"></span></p>\n      </div>\n      \n      <div id="offlineWarning" style="display: none; background: rgba(255,193,7,0.1); padding: 15px; border-radius: 8px; margin: 15px 0;">\n        <p>Cannot verify date (offline). Last verified:</p>\n        <p><strong>Last Valid Date:</strong> <span id="lastValidDateDisplay"></span></p>\n        <p><strong>Time Since Last Check:</strong> <span id="offlineDuration"></span></p>\n      </div>\n      \n      <p style="margin-top: 20px; color: #aaa; font-size: 0.9em;">\n        Please ensure your device has the correct date and internet connection.\n      </p>\n    </div>\n  ',document.body.appendChild(l),setInterval(validateDate,3e4),setInterval((function quickDateCheck(){if(!n||!a)return;const e=getCurrentDate();datesMatch(e,n)||handleDateViolation(e,n)}),1e3),window.addEventListener("focus",validateDate),validateDate(),window.getDateValidationStatus=function(){return{isValid:a,lastValidDate:n?formatDate(n):null,violationCount:o,isOnline:Date.now()-i<6e4}}}();
